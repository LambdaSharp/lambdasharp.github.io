<!DOCTYPE html>
<html lang="en">
  
  <head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-147535443-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-147535443-1');
    </script>
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="LambdaSharp &quot;Favorinus&quot; Release (v0.6) | LambdaSharp - Serverless .NET for AWS">
    <meta name="description" content="Release notes for LambdaSharp &quot;Favorinus&quot; (v0.6)">
    <meta name="keywords" content="release, notes, favorinus, lambdasharp, lambda sharp, aws, serverless, .net, dotnet, .net core, dotnetcore, c#, c sharp">
    <meta name="generator" content="docfx 2.59.0.0">
    <meta name="robots" content="index,follow">
  
    <meta property="og:title" content="LambdaSharp &quot;Favorinus&quot; Release (v0.6) | LambdaSharp - Serverless .NET for AWS">
    <meta property="og:site_name" content="LambdaSharp - Serverless .NET for AWS">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en_US">
    <meta property="og:url" content="https://lambdasharp.net/articles/ReleaseNotes-Favorinus.html">
    <meta property="og:image" content="https://lambdasharp.net/images/LambdaSharpBadge.png">
    <meta property="og:description" content="Release notes for LambdaSharp &quot;Favorinus&quot; (v0.6)">
  
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="LambdaSharp &quot;Favorinus&quot; Release (v0.6) | LambdaSharp - Serverless .NET for AWS">
    <meta name="twitter:site" content="@lambdasharp">
    <meta name="twitter:description" content="Release notes for LambdaSharp &quot;Favorinus&quot; (v0.6)">
    <meta name="twitter:image" content="https://lambdasharp.net/images/LambdaSharpBadge.png">
  
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
  
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:newtab" content="true">
  
    <title>LambdaSharp &quot;Favorinus&quot; Release (v0.6) | LambdaSharp - Serverless .NET for AWS </title>
    <link rel="canonical" href="https://lambdasharp.net/articles/ReleaseNotes-Favorinus.html">
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/LambdaSharpLogo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="lambdasharp---favorinus-v061---2019-09-05">LambdaSharp - Favorinus (v0.6.1) - 2019-09-05</h1>

<blockquote>
<p>Favorinus had extensive knowledge, combined with great oratorical powers, that raised him to eminence both in Athens and in Rome. He lived on close terms with Plutarch, with Herodes Atticus, to whom he bequeathed his library in Rome, with Demetrius the Cynic, Cornelius Fronto, Aulus Gellius, and with the emperor Hadrian. <a href="https://en.wikipedia.org/wiki/Favorinus">(Wikipedia)</a></p>
</blockquote>
<h2 id="whats-new">What's New</h2>
<p>This release focuses on API Gateway, both for REST APIs and WebSockets. After building the Lambda functions, LambdaSharp analyzes the compiled assemblies to enhance the API Gateway rout definitions in CloudFormation. For example, LambdaSharp will extract the JSON schema from the target methods to create request validation rules for API Gateway. This enables API Gateway to block requests before they reach the Lambda function. In addition, LambdaSharp allows checks if the target method returns a response. If not, API Gateway will be configured to invoke the Lambda function asynchronously, providing much faster response times.</p>
<p>In addition, there is a <a href="https://lambdasharp.net">new documentation site</a> that covers all aspects of LambdaSharp, including the base classes, modules, and syntax.</p>
<h2 id="breaking-changes">BREAKING CHANGES</h2>
<p>The following change may impact modules created with previous releases.</p>
<h3 id="lambdasharp-cli">LambdaSharp CLI</h3>
<ul>
<li>The <code>git-sha</code> is now prefixed with <code>DIRTY-</code> if the git checkout contains modified or untracked files.</li>
</ul>
<h3 id="lambdasharp-assemblies">LambdaSharp Assemblies</h3>
<p>The LambdaSharp dependencies were updated to <code>Amazon.Lambda.Core v1.1.0</code> and <code>Amazon.Lambda.Serialization.Json v1.5.0</code>. All projects need their dependencies updated to reflect this change. Otherwise, a compilation error will occur.</p>
<p>The <code>LambdaSharp.dll</code> assembly was refactored for consistency. Classes are now organized into the following namespaces:</p>
<ul>
<li><code>LambdaSharp</code>: Common base classes, such as <a class="xref" href="../sdk/LambdaSharp/LambdaSharp.ALambdaFunction.html">ALambdaFunction</a> and <a class="xref" href="../sdk/LambdaSharp/LambdaSharp.LambdaConfig.html">LambdaConfig</a>.</li>
<li><code>LambdaSharp.ApiGateway</code>: Classes relating to <a class="xref" href="../sdk/LambdaSharp.ApiGateway/LambdaSharp.ApiGateway.ALambdaApiGatewayFunction.html">ALambdaApiGatewayFunction</a>.</li>
<li><code>LambdaSharp.ConfigSource</code>: Classes for reading configuration information. Usually not required.</li>
<li><code>LambdaSharp.CustomResource</code>: Classes relating to <a class="xref" href="../sdk/LambdaSharp.CustomResource/LambdaSharp.CustomResource.ALambdaCustomResourceFunction-2.html">ALambdaCustomResourceFunction&lt;TProperties,TAttributes&gt;</a>.</li>
<li><code>LambdaSharp.ErrorReports</code>: Classes for generating error reports. Usually not required.</li>
<li><code>LambdaSharp.Exceptions</code>: Classes for throwing exceptions. Usually not required.</li>
<li><code>LambdaSharp.Finalizer</code>: Classes relating to <a class="xref" href="../sdk/LambdaSharp.Finalizer/LambdaSharp.Finalizer.ALambdaFinalizerFunction.html">ALambdaFinalizerFunction</a>.</li>
<li><code>LambdaSharp.Logger</code>: Classes for basic logging. Usually not required.</li>
<li><code>LambdaSharp.Schedule</code>: Classes relating to <a class="xref" href="../sdk/LambdaSharp.Schedule/LambdaSharp.Schedule.ALambdaScheduleFunction.html">ALambdaScheduleFunction</a>.</li>
<li><code>LambdaSharp.SimpleNotificationService</code>: Classes relating to <a class="xref" href="../sdk/LambdaSharp.SimpleNotificationService/LambdaSharp.SimpleNotificationService.ALambdaTopicFunction-1.html">ALambdaTopicFunction<tmessage></tmessage></a>.</li>
<li><code>LambdaSharp.SimpleQueueService</code>: Classes relating to [ALambdaQueueFunction<tmessage><code>](xref:LambdaSharp.SimpleQueueService.ALambdaQueueFunction</code>1).</tmessage></li>
</ul>
<p>Other functional changes include:</p>
<ul>
<li>The <code>RequestId</code> property in <code>ALambdaFunction</code> was replaced by the more generic <code>CurrentContext</code> property. Old code needs to be updated to use <code>CurrentContext.AwsRequestId</code> instead.</li>
<li>The <code>ILambdaContext context</code> parameter was removed in favor of the <code>CurrentContext</code> property.</li>
<li>Methods starting with <code>HandleXYZ</code> were renamed to <code>ProcessXYZ</code> for consistency.</li>
</ul>
<h2 id="new-lambdasharp-module-features">New LambdaSharp Module Features</h2>
<h3 id="api-gateway-net">API Gateway .NET</h3>
<p>The <code>Api</code> event-source now supports specifying a target invocation method using the <code>Invoke</code> attribute. At compile time, LambdaSharp CLI verifies that the target method exists in the compiled assembly. In addition, LambdaSharp generates the request/response JSON schema models for the method and uses them to configure API Gateway. If the method has either <code>void</code> or <code>Task</code> as return type, LambdaSharp will configure the lambda function as an asynchronous invocation in API Gateway. Note, for this behavior to take effect, the Lambda function must derive from <code>ALambdaApiGatewayFunction</code>.</p>
<pre><code class="lang-yaml">- Function: MyFunction
  Memory: 256
  Timeout: 30
  Sources:

    - Api: POST:/items
      Invoke: AddItem
</code></pre>
<p>The target method can now be implemented in a straightforward way, without requiring deserializing or validation.</p>
<pre><code class="lang-csharp">public AddItemResponse AddItem(AddItemRequest request) {

    // add new item to list
    var item = new Item {
        Id = Guid.NewGuid().ToString(&quot;N&quot;),
        Value = request.Value
    };
    _items.Add(item);

    // respond with new item ID
    return new AddItemResponse {
        Id = item.Id
    };
}
</code></pre>
<h3 id="websockets-net">WebSockets .NET</h3>
<p>A new <code>WebSocket</code> event-source is now supported. Similar to the <code>Api</code> event-source, <code>WebSocket</code> supports specifying a target invocation method using the <code>Invoke</code> attribute. At compile time, LambdaSharp CLI verifies that the target method exists in the compiled assembly. In addition, LambdaSharp generates the request/response JSON schema models for the method and uses them to configure API Gateway v2. If the method has either <code>void</code> or <code>Task</code> as return type, LambdaSharp will configure the lambda function as an asynchronous invocation in API Gateway v2. Otherwise, it will be configured for bidirectional communication. Note, for this behavior to take effect, the Lambda function must derive from <code>ALambdaApiGatewayFunction</code>.</p>
<pre><code class="lang-yaml">- Function: MessageFunction
  Memory: 256
  Timeout: 30
  Sources:

    - WebSocket: send
      Invoke: SendMessageAsync
</code></pre>
<p>The target method can now be implemented in a straightforward way, without requiring deserializing or validation. The method uses the <code>WebSocketClient</code> property, which is inherited from the base class. The <code>WebSocketClient</code> returns the <code>IAmazonApiGatewayManagementApi</code> instance when <code>ALambdaApiGatewayFunction</code> was instantiated with a WebSocket URL.</p>
<pre><code class="lang-csharp">public Task SendMessageAsync(Message request) {

    // echo message back
    return WebSocketClient.PostToConnectionAsync(new PostToConnectionRequest {
        ConnectionId = CurrentRequest.RequestContext.ConnectionId,
        Data = SerializeJson(new Message {
            From = request.From,
            Text = request.Text
        }).ToStream()
    });
}
</code></pre>
<h3 id="api-gateway-cloudwatch-log">API Gateway CloudWatch Log</h3>
<p>The API Gateway CloudWatch log is now created--and therefore, deleted--by CloudFormation.</p>
<h2 id="new-lambdasharp-cli-features">New LambdaSharp CLI Features</h2>
<h3 id="build-command">Build Command</h3>
<p>The <code>--module-version</code> option was added to allow overriding the version of the module being compiled. This capability is useful in build pipelines where a script needs to set the current version number.</p>
<p>In addition, the captured git-sha is now prepended with <code>DIRTY-</code> when there are uncommitted/untracked changes when the module is built.</p>
<h3 id="publish-command">Publish Command</h3>
<p>The <code>--force-publish</code> option was modified to publish all assets even even when the checksums match.</p>
<h3 id="deploy-command">Deploy Command</h3>
<p>All CloudFormation stacks are now tagged with <code>LambdaSharp:DeployedBy</code> to capture the identity of who deployed the stack.</p>
<h3 id="new-command">New Command</h3>
<p>The <code>new module</code>, <code>new function</code>, and <code>new resource</code> commands will now prompt for the name and type when omitted.</p>
<p>The <code>new resource</code> command now also inserts a documentation link with the newly added resource declaration. In addition, if the exact resource name cannot be found, the <code>new resource</code> command will show partial matches.</p>
<pre><code class="lang-yaml">- Resource: MyTopic
  Description: TO-DO - update resource description
  Type: AWS::SNS::Topic
  Properties:
    # Documentation: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-sns-topic.html
    DisplayName: String
    KmsMasterKeyId: String
    Subscription:
      - Endpoint: String # Required
        Protocol: String # Required
    TopicName: String
</code></pre>
<h3 id="util-command">Util Command</h3>
<p>The <code>util create-invoke-methods-schema</code> was added to help generate JSON schema from compiled methods to be used with <code>ALambdaApiGatewayFunction</code>.</p>
<h3 id="list-command">List Command</h3>
<p>The output of the <code>list</code> command was enhanced to show the module name and version.</p>
<pre><code class="lang-bash">lash list --tier Sandbox
</code></pre>
<p>Output:</p>
<pre><code>LambdaSharp CLI (v0.6) - List deployed LambdaSharp modules

Found 2 modules for deployment tier 'Default'

NAME                 MODULE                   STATUS             DATE
LambdaSharp-Core     LambdaSharp.Core:0.6     UPDATE_COMPLETE    2019-04-05 10:36:49
LambdaSharp-S3-IO    LambdaSharp.S3.IO:0.6    UPDATE_COMPLETE    2019-04-05 10:37:19

Done (finished: 4/5/2019 3:36:10 PM; duration: 00:00:01.4137682)
</code></pre>
<h3 id="init-command">Init Command</h3>
<p>The <code>init</code> command was improved to detect previous versions of a deployment tier and prompt for perform an upgrade operation, similar to the <code>config</code> command.</p>
<h2 id="new-lambdasharp-assembly-features">New LambdaSharp Assembly Features</h2>
<p>This release adds <a class="xref" href="../sdk/LambdaSharp.SimpleQueueService/LambdaSharp.SimpleQueueService.ALambdaQueueFunction-1.html"><code>ALambdaQueueFunction&lt;T&gt;</code></a> as base class for processing messages from SQS queues.</p>
<p>The <a class="xref" href="../sdk/LambdaSharp.ApiGateway/LambdaSharp.ApiGateway.ALambdaApiGatewayFunction.html"><code>ALambdaApiGatewayFunction</code></a> was also enhanced to provide support for target methods invocations.</p>
<h2 id="releases">Releases</h2>
<h3 id="v061---2019-09-05">(v0.6.1) - 2019-09-05</h3>
<ul>
<li>Removed automatic dependency <code>DefaultSecretKey</code> to enable streamlined upgrade to v0.7.0.</li>
<li>Fixed a JSON schema issue when using <code>enum</code> property type.</li>
</ul>
<h3 id="v0603---2019-07-01">(v0.6.0.3) - 2019-07-01</h3>
<h4 id="new-features">New Features</h4>
<ul>
<li>Added <code>--decrypt</code> option to <code>lash encrypt</code>, which decrypts the supplied value before encrypting it again. Useful when changing secret keys.</li>
<li>Enhanced <code>lash tier coreservices</code> to also show nested stacks, but ignore them when using either the <code>--enable</code> or <code>--disable</code> options.</li>
</ul>
<h4 id="fixes">Fixes</h4>
<ul>
<li>Fixed an issue where the IAM policy for using secret keys was not created/updated before the embedded <code>DecryptionSecret</code> function was invoked, leading to a CloudFormation failure.</li>
</ul>
<h3 id="v0602---2019-06-26">(v0.6.0.2) - 2019-06-26</h3>
<h4 id="new-features-1">New Features</h4>
<ul>
<li>Modules are now compiled with a new <code>LambdaSharpCoreServices</code> parameter that controls if a module binds to LambdaSharp Core Services.</li>
<li>Added <code>lash tier coreservices</code> command to enable/disable the use of LambdaSharp Core Services in deployed modules.</li>
<li>Added standard module output parameter <code>LambdaSharpTool</code> that captures the version of the LambdaSharp CLI used to build the module.</li>
</ul>
<h4 id="fixes-1">Fixes</h4>
<ul>
<li>Fixed an issue where exceptions thrown in pending tasks submitted using <code>ALambdaFunction.RunTask()</code> did not cause the Lambda function to fail.</li>
<li>Fixed an issue where <code>lash config</code> failed to properly initialize the API Gateway Account role when it was set to a deleted role.</li>
<li>Fixed an issue where the physical ID instead of the ARN was used for custom resource handlers when the handler was a Lambda function.</li>
<li>Mismatched <code>lambdasharp</code> assembly version is now reported as a warning instead of an error when running in contributor mode.</li>
<li>Disabled warnings for potentially invalid references to conditional resources, because of too many false negatives.</li>
</ul>
<h3 id="v0601---2019-06-11">(v0.6.0.1) - 2019-06-11</h3>
<h4 id="updated-documentation">Updated Documentation</h4>
<ul>
<li>Added documentation for <a href="APIGateway.html">API Gateway for .NET</a>.</li>
<li>Added <a href="VideoTutorials.html">Video Tutorials</a> section.</li>
</ul>
<h4 id="new-features-2">New Features</h4>
<ul>
<li>X-Ray Tracing now works for API Gateway V1 and Nested Modules.</li>
<li>Updated CloudFormation spec to 3.3.0.</li>
<li>Colorized warning and errors in console output.</li>
<li>Added <code>ALambdaFunction.RunTask()</code> and <code>ALambdaFunction.AddPendingTask(Task)</code> to queue background operations that must complete before the Lambda invocation finishes.</li>
<li>Added <code>HttpClient</code> with X-Ray tracing instrumentation to <code>ALambdaFunction</code> base class.</li>
<li><code>ALambdaFunction</code> now unrolls <code>AggregateException</code> instances and reports errors individually.</li>
<li><code>lash util delete-orphan-logs</code> replaces <code>delete-orphan-lambda-logs</code>, which now also delete orphaned API Gateway CloudWatch logs</li>
</ul>
<h4 id="fixes-2">Fixes</h4>
<ul>
<li>Fixed an issue with setting the correct IAM role for the API Gateway account.</li>
<li>Various bug fixes to generating the proper JSON schema for API Gateway endpoints and routes.</li>
<li><code>lash publish</code> now warns if version already exists instead of reporting an error.</li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
