<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>&#955;# - Favorinus (v0.6-RC2) - TBD | &#955;# - Serverless .NET for AWS </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="&#955;# - Favorinus (v0.6-RC2) - TBD | &#955;# - Serverless .NET for AWS ">
    <meta name="generator" content="docfx 2.42.0.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    <meta property="docfx:newtab" content="true">
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/LambdaSharpLogo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="λ---favorinus-v06-rc2---tbd">λ# - Favorinus (v0.6-RC2) - TBD</h1>

<blockquote>
<p>Favorinus had extensive knowledge, combined with great oratorical powers, that raised him to eminence both in Athens and in Rome. He lived on close terms with Plutarch, with Herodes Atticus, to whom he bequeathed his library in Rome, with Demetrius the Cynic, Cornelius Fronto, Aulus Gellius, and with the emperor Hadrian. <a href="https://en.wikipedia.org/wiki/Favorinus">(Wikipedia)</a></p>
</blockquote>
<h2 id="whats-new">What's New</h2>
<p>This release focuses on API Gateway, both for REST APIs and Web-Sockets. After building the Lambda functions, λ# analyzes the compiled assemblies to enhance the API Gateway rout definitions in CloudFormation. For example, λ# will extract the JSON schema from the target methods to create request validation rules for API Gateway. This enables API Gateway to block requests before they reach the Lambda function. In addition, λ# allows checks if the target method returns a response. If not, API Gateway will be configured to invoke the Lambda function asynchronously, providing much faster response times.</p>
<p>In particular, the λ# CLI now uses reflection to examine the target methods for API Gateway routes</p>
<h2 id="breaking-changes">BREAKING CHANGES</h2>
<p>The following change may impact modules created with previous releases.</p>
<h3 id="λ-tool">λ# Tool</h3>
<ul>
<li>The <code>git-sha</code> is now prefixed with <code>DIRTY-</code> if the git checkout contains modified or untracked files.</li>
</ul>
<h3 id="λ-assemblies">λ# Assemblies</h3>
<p>The λ# were refactored for consistency with the following breaking changes:</p>
<ul>
<li>The <code>RequestId</code> property in <code>ALambdaFunction</code> was replaced by the more generic <code>CurrentContext</code> property. Old code needs to be updated to use <code>CurrentContext.AwsRequestId</code> instead.</li>
<li>The <code>ALambdaTopicFunction&lt;TMessage&gt;</code> base class was moved to the <code>LambdaSharp.SimpleNotificationService</code> namespace.</li>
<li>The <code>ALambdaApiGatewayFunction</code> was renamed to <code>ALambdaAPIGatewayFunction</code> and moved to the <code>LambdaSharp.APIGateway</code> namespace.</li>
<li>The <code>ILambdaContext context</code> parameter was removed in favor of the <code>CurrentContext</code> property.</li>
<li>Methods starting with <code>HandleXYZ</code> were renamed to <code>ProcessXYZ</code> for consistency.</li>
</ul>
<h2 id="new-λ-module-features">New λ# Module Features</h2>
<h3 id="api-gateway-net">API Gateway .NET</h3>
<p>The <code>Api</code> event-source now supports specifying a target invocation method using the <code>Invoke</code> attribute. At compile time, λ# CLI verifies that the target method exists in the compiled assembly. In addition, λ# generates the request/response JSON schema models for the method and uses them to configure API Gateway. If the method has either <code>void</code> or <code>Task</code> as return type, λ# will configure the lambda function as an asynchronous invocation in API Gateway. Note, for this behavior to take effect, the Lambda function must derive from <code>ALambdaAPIGatewayFunction</code>.</p>
<pre><code class="lang-yaml">- Function: MyFunction
  Memory: 256
  Timeout: 30
  Sources:

    - Api: POST:/items
      Invoke: AddItem
</code></pre>
<p>The target method can now be implemented in a straightforward way, without requiring deserializing or validation.</p>
<pre><code class="lang-csharp">public AddItemResponse AddItem(AddItemRequest request) {

    // add new item to list
    var item = new Item {
        Id = Guid.NewGuid().ToString(&quot;N&quot;),
        Value = request.Value
    };
    _items.Add(item);

    // respond with new item ID
    return new AddItemResponse {
        Id = item.Id
    };
}
</code></pre>
<h3 id="websockets-net">WebSockets .NET</h3>
<p>A new <code>WebSocket</code> event-source is now supported. Similar to the <code>Api</code> event-source, <code>WebSocket</code> supports specifying a target invocation method using the <code>Invoke</code> attribute. At compile time, λ# CLI verifies that the target method exists in the compiled assembly. In addition, λ# generates the request/response JSON schema models for the method and uses them to configure API Gateway v2. If the method has either <code>void</code> or <code>Task</code> as return type, λ# will configure the lambda function as an asynchronous invocation in API Gateway v2. Otherwise, it will be configured for bidirectional communication. Note, for this behavior to take effect, the Lambda function must derive from <code>ALambdaAPIGatewayFunction</code>.</p>
<pre><code class="lang-yaml">- Function: MessageFunction
  Memory: 256
  Timeout: 30
  Sources:

    - WebSocket: send
      Invoke: SendMessageAsync
</code></pre>
<p>The target method can now be implemented in a straightforward way, without requiring deserializing or validation. The method uses the <code>WebSocketClient</code> property, which is inherited from the base class. The <code>WebSocketClient</code> returns the <code>IAmazonApiGatewayManagementApi</code> instance when <code>ALambdaAPIGateway</code> was instantiated with a web-socket URL.</p>
<pre><code class="lang-csharp">public Task SendMessageAsync(Message request) {

    // echo message back
    return WebSocketClient.PostToConnectionAsync(new PostToConnectionRequest {
        ConnectionId = CurrentRequest.RequestContext.ConnectionId,
        Data = SerializeJson(new Message {
            From = request.From,
            Text = request.Text
        }).ToStream()
    });
}
</code></pre>
<h3 id="api-gateway-cloudwatch-log">API Gateway CloudWatch Log</h3>
<p>The API Gateway CloudWatch log is now created--and therefore, deleted--by CloudFormation.</p>
<h2 id="new-λ-cli-features">New λ# CLI Features</h2>
<h3 id="publish-command">Publish Command</h3>
<p>The <code>--force-publish</code> option was modified to publish all assets even even when the checksums match.</p>
<h3 id="deploy-command">Deploy Command</h3>
<p>All CloudFormation stacks are now tagged with <code>LambdaSharp:DeployedBy</code> to capture the identity of who deployed the stack.</p>
<h3 id="new-command">New Command</h3>
<p>The <code>new resource</code> command now also inserts a documentation link with the newly added resource declaration. In addition, if the exact resource name cannot be found, the <code>new resource</code> command will show partial matches.</p>
<pre><code class="lang-yaml">- Resource: MyTopic
  Description: TODO - update resource description
  Type: AWS::SNS::Topic
  Properties:
    # Documentation: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-sns-topic.html
    DisplayName: String
    KmsMasterKeyId: String
    Subscription:
      - Endpoint: String # Required
        Protocol: String # Required
    TopicName: String
</code></pre>
<h3 id="util-command">Util Command</h3>
<p>The <code>util create-invoke-methods-schema</code> was added to help generate JSON schema from compiled methods to be used with <code>ALambdaAPIGatewayFunction</code>.</p>
<h3 id="list-command">List Command</h3>
<p>The output of the <code>list</code> command was enhanced to show the module name and version.</p>
<pre><code class="lang-bash">lash list --tier Sandbox
</code></pre>
<p>Output:</p>
<pre><code>LambdaSharp CLI (v0.6) - List deployed LambdaSharp modules

Found 2 modules for deployment tier 'Default'

NAME                 MODULE                   STATUS             DATE
LambdaSharp-Core     LambdaSharp.Core:0.6     UPDATE_COMPLETE    2019-04-05 10:36:49
LambdaSharp-S3-IO    LambdaSharp.S3.IO:0.6    UPDATE_COMPLETE    2019-04-05 10:37:19

Done (finished: 4/5/2019 3:36:10 PM; duration: 00:00:01.4137682)
</code></pre>
<h3 id="init-command">Init Command</h3>
<p>The <code>init</code> command was improved to detect previous versions of a deployment tier and prompt for perform an upgrade operation, similar to the <code>config</code> command.</p>
<h2 id="new-λ-assembly-features">New λ# Assembly Features</h2>
<p>This release adds <a class="xref" href="../sdk/LambdaSharp.SimpleQueueService.ALambdaQueueFunction-1.html"><code>ALambdaQueueFunction&lt;T&gt;</code></a> as base class for processing messages from SQS queues.</p>
<p>The <a class="xref" href="../sdk/LambdaSharp.ApiGateway.ALambdaApiGatewayFunction.html"><code>ALambdaAPIGatewayFunction</code></a> was also enhanced to provide support for target methods invocations.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
